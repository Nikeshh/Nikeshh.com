generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model BlogPost {
  id               Int                @id @default(autoincrement())
  title            String
  content          String?            @db.LongText
  published        Boolean            @default(false)
  authorId         String
  comments         BlogComment[]
  categories       BlogCategory[]     @relation("BlogPostCategories")
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  blogPostCategory BlogPostCategory[]
}

model BlogComment {
  id        Int      @id @default(autoincrement())
  content   String
  postId    Int
  post      BlogPost @relation(fields: [postId], references: [id])
  authorId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BlogCategory {
  id               Int                @id @default(autoincrement())
  name             String             @unique
  posts            BlogPost[]         @relation("BlogPostCategories")
  blogPostCategory BlogPostCategory[]
}

// Join table to establish many-to-many relationship. A single blog post can have multiple categories and a single category can have multiple blog posts
model BlogPostCategory {
  postId     Int
  categoryId Int
  post       BlogPost     @relation(fields: [postId], references: [id])
  category   BlogCategory @relation(fields: [categoryId], references: [id])

  @@id([postId, categoryId])
}
